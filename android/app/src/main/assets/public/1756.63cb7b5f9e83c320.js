"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1756],{1756:(U,_,c)=>{c.r(_),c.d(_,{VetHomePageModule:()=>N});var d=c(177),g=c(9417),s=c(4742),h=c(4964),m=c(467),e=c(4438);function f(o,r){if(1&o&&(e.j41(0,"div")(1,"p")(2,"strong"),e.EFF(3),e.nI1(4,"date"),e.k0s(),e.nrm(5,"br"),e.EFF(6),e.nrm(7,"br"),e.EFF(8," Estado: "),e.j41(9,"ion-badge",8),e.EFF(10),e.k0s()()()),2&o){const n=r.$implicit,t=e.XpG(2);e.R7$(3),e.JRh(e.i5U(4,4,n.fecha,"dd/MM/yyyy HH:mm")),e.R7$(3),e.SpI(" Motivo: ",n.motivo,""),e.R7$(3),e.Y8G("color",t.getColorEstado(n.estado)),e.R7$(),e.JRh(n.estado)}}function v(o,r){if(1&o&&(e.qex(0),e.DNE(1,f,11,7,"div",7),e.bVm()),2&o){const n=e.XpG();e.R7$(),e.Y8G("ngForOf",n.citasMascota)}}function C(o,r){1&o&&(e.j41(0,"p"),e.EFF(1,"No hay historial de citas"),e.k0s())}let E=(()=>{var o;class r{constructor(t){this.modalController=t,this.citasMascota=[]}getColorEstado(t){switch(t){case"pendiente":return"warning";case"en_proceso":return"primary";case"completada":return"success";case"cancelada":return"danger";default:return"medium"}}cerrar(){this.modalController.dismiss()}}return(o=r).\u0275fac=function(t){return new(t||o)(e.rXU(s.W3))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-detalle-mascota-modal"]],inputs:{mascota:"mascota",dueno:"dueno",citasMascota:"citasMascota"},decls:38,vars:10,consts:[["noCitas",""],[1,"ion-padding"],["lines","none"],["name","paw","slot","start","color","primary"],["name","calendar","slot","start","color","primary"],[4,"ngIf","ngIfElse"],["expand","block","color","medium",3,"click"],[4,"ngFor","ngForOf"],[3,"color"]],template:function(t,a){if(1&t){const i=e.RV6();e.j41(0,"ion-content",1)(1,"ion-list")(2,"ion-item",2),e.nrm(3,"ion-icon",3),e.j41(4,"ion-label")(5,"h2"),e.EFF(6,"Informaci\xf3n de la Mascota"),e.k0s(),e.j41(7,"p")(8,"strong"),e.EFF(9,"Nombre:"),e.k0s(),e.EFF(10),e.k0s(),e.j41(11,"p")(12,"strong"),e.EFF(13,"Especie:"),e.k0s(),e.EFF(14),e.k0s(),e.j41(15,"p")(16,"strong"),e.EFF(17,"Raza:"),e.k0s(),e.EFF(18),e.k0s(),e.j41(19,"p")(20,"strong"),e.EFF(21,"Edad:"),e.k0s(),e.EFF(22),e.k0s(),e.j41(23,"p")(24,"strong"),e.EFF(25,"Fecha de Nacimiento:"),e.k0s(),e.EFF(26),e.nI1(27,"date"),e.k0s()()(),e.j41(28,"ion-item",2),e.nrm(29,"ion-icon",4),e.j41(30,"ion-label")(31,"h2"),e.EFF(32,"Historial de Citas"),e.k0s(),e.DNE(33,v,2,1,"ng-container",5)(34,C,2,0,"ng-template",null,0,e.C5r),e.k0s()()(),e.j41(36,"ion-button",6),e.bIt("click",function(){return e.eBV(i),e.Njj(a.cerrar())}),e.EFF(37," Cerrar "),e.k0s()()}if(2&t){const i=e.sdS(35);e.R7$(10),e.SpI(" ",a.mascota.nombre,""),e.R7$(4),e.SpI(" ",a.mascota.especie,""),e.R7$(4),e.SpI(" ",a.mascota.raza,""),e.R7$(4),e.SpI(" ",a.mascota.edad," a\xf1os"),e.R7$(4),e.SpI(" ",e.i5U(27,7,a.mascota.fechaNacimiento,"dd/MM/yyyy"),""),e.R7$(7),e.Y8G("ngIf",a.citasMascota.length>0)("ngIfElse",i)}},dependencies:[d.Sq,d.bT,s.In,s.Jm,s.W9,s.iq,s.uz,s.he,s.nf,d.vh],encapsulation:2}),r})(),I=(()=>{var o;class r{constructor(t){this.modalController=t}getColorEstado(t){switch(t){case"pendiente":return"warning";case"en_proceso":return"primary";case"completada":return"success";case"cancelada":return"danger";default:return"medium"}}cambiarEstado(){var t=this;return(0,m.A)(function*(){t.modalController.dismiss({action:"cambiarEstado",cita:t.cita})})()}cerrar(){this.modalController.dismiss()}}return(o=r).\u0275fac=function(t){return new(t||o)(e.rXU(s.W3))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-detalle-cita-modal"]],inputs:{cita:"cita",mascota:"mascota",dueno:"dueno"},decls:45,vars:10,consts:[[1,"ion-padding"],["lines","none"],["name","calendar","slot","start","color","primary"],["name","paw","slot","start","color","primary"],["name","document-text","slot","start","color","primary"],[3,"color"],["expand","block","color","primary",3,"click"],["expand","block","color","medium",3,"click"]],template:function(t,a){1&t&&(e.j41(0,"ion-content",0)(1,"ion-list")(2,"ion-item",1),e.nrm(3,"ion-icon",2),e.j41(4,"ion-label")(5,"h2"),e.EFF(6,"Fecha y Hora"),e.k0s(),e.j41(7,"p"),e.EFF(8),e.nI1(9,"date"),e.k0s()()(),e.j41(10,"ion-item",1),e.nrm(11,"ion-icon",3),e.j41(12,"ion-label")(13,"h2"),e.EFF(14,"Informaci\xf3n de la Mascota"),e.k0s(),e.j41(15,"p")(16,"strong"),e.EFF(17,"Nombre:"),e.k0s(),e.EFF(18),e.k0s(),e.j41(19,"p")(20,"strong"),e.EFF(21,"Especie:"),e.k0s(),e.EFF(22),e.k0s(),e.j41(23,"p")(24,"strong"),e.EFF(25,"Raza:"),e.k0s(),e.EFF(26),e.k0s()()(),e.j41(27,"ion-item",1),e.nrm(28,"ion-icon",4),e.j41(29,"ion-label")(30,"h2"),e.EFF(31,"Detalles de la Cita"),e.k0s(),e.j41(32,"p")(33,"strong"),e.EFF(34,"Motivo:"),e.k0s(),e.EFF(35),e.k0s(),e.j41(36,"p")(37,"strong"),e.EFF(38,"Estado:"),e.k0s(),e.j41(39,"ion-badge",5),e.EFF(40),e.k0s()()()()(),e.j41(41,"ion-button",6),e.bIt("click",function(){return a.cambiarEstado()}),e.EFF(42," Cambiar Estado "),e.k0s(),e.j41(43,"ion-button",7),e.bIt("click",function(){return a.cerrar()}),e.EFF(44," Cerrar "),e.k0s()()),2&t&&(e.R7$(8),e.JRh(e.i5U(9,7,a.cita.fecha,"dd/MM/yyyy HH:mm")),e.R7$(10),e.SpI(" ",null==a.mascota?null:a.mascota.nombre,""),e.R7$(4),e.SpI(" ",null==a.mascota?null:a.mascota.especie,""),e.R7$(4),e.SpI(" ",null==a.mascota?null:a.mascota.raza,""),e.R7$(9),e.SpI(" ",a.cita.motivo,""),e.R7$(4),e.Y8G("color",a.getColorEstado(a.cita.estado)),e.R7$(),e.JRh(a.cita.estado))},dependencies:[s.In,s.Jm,s.W9,s.iq,s.uz,s.he,s.nf,d.vh],encapsulation:2}),r})();var k=c(4035),M=c(6898),j=c(4796);function b(o,r){if(1&o&&(e.j41(0,"ion-item-sliding")(1,"ion-item")(2,"ion-label")(3,"h2"),e.EFF(4),e.nI1(5,"date"),e.k0s(),e.j41(6,"p"),e.EFF(7),e.k0s(),e.j41(8,"p"),e.EFF(9),e.k0s()()()()),2&o){let n;const t=r.$implicit,a=e.XpG(2);e.R7$(4),e.Lme("",e.i5U(5,4,t.fecha,"HH:mm")," - ",null==(n=a.getMascotaInfo(t.mascotaId))?null:n.nombre,""),e.R7$(3),e.SpI("Motivo: ",t.motivo,""),e.R7$(2),e.SpI("Estado: ",t.estado,"")}}function D(o,r){1&o&&(e.j41(0,"ion-text",14)(1,"p"),e.EFF(2,"No hay citas programadas para este d\xeda"),e.k0s()())}function R(o,r){if(1&o){const n=e.RV6();e.j41(0,"div",9)(1,"ion-datetime",10),e.bIt("ionChange",function(a){e.eBV(n);const i=e.XpG();return e.Njj(i.onDateChanged(a))}),e.k0s(),e.j41(2,"div",11)(3,"h2",9),e.EFF(4),e.nI1(5,"date"),e.k0s(),e.j41(6,"ion-list"),e.DNE(7,b,10,7,"ion-item-sliding",12),e.k0s(),e.DNE(8,D,3,0,"ion-text",13),e.k0s()()}if(2&o){const n=e.XpG();e.R7$(),e.Y8G("value",n.selectedDate),e.R7$(3),e.SpI("Citas del d\xeda ",e.i5U(5,4,n.selectedDate,"dd/MM/yyyy"),""),e.R7$(3),e.Y8G("ngForOf",n.citasDelDia),e.R7$(),e.Y8G("ngIf",0===n.citasDelDia.length)}}function y(o,r){if(1&o){const n=e.RV6();e.j41(0,"ion-item",20),e.bIt("click",function(){const a=e.eBV(n).$implicit,i=e.XpG(2);return e.Njj(i.verDetalleCita(a))}),e.j41(1,"ion-label")(2,"h2"),e.EFF(3),e.nI1(4,"date"),e.k0s(),e.j41(5,"h3"),e.EFF(6),e.k0s(),e.j41(7,"h3"),e.EFF(8),e.k0s(),e.j41(9,"p"),e.EFF(10),e.k0s(),e.j41(11,"ion-badge",21),e.EFF(12),e.k0s()()()}if(2&o){let n,t;const a=r.$implicit,i=e.XpG(2);e.R7$(3),e.SpI("Fecha: ",e.i5U(4,6,a.fecha,"dd/MM/yyyy HH:mm"),""),e.R7$(3),e.SpI("Mascota: ",null==(n=i.getMascotaInfo(a.mascotaId))?null:n.nombre,""),e.R7$(2),e.SpI("Due\xf1o: ",null==(t=i.getUserInfo((null==(t=i.getMascotaInfo(a.mascotaId))?null:t.usuarioId)||""))?null:t.nombre,""),e.R7$(2),e.SpI("Motivo: ",a.motivo,""),e.R7$(),e.Y8G("color",i.getColorEstado(a.estado)),e.R7$(),e.JRh(a.estado)}}function V(o,r){1&o&&(e.j41(0,"ion-text",14)(1,"p"),e.EFF(2,"No hay citas con el filtro seleccionado"),e.k0s()())}function $(o,r){if(1&o){const n=e.RV6();e.j41(0,"div")(1,"ion-item")(2,"ion-label"),e.EFF(3,"Filtrar por estado"),e.k0s(),e.j41(4,"ion-select",3),e.mxI("ngModelChange",function(a){e.eBV(n);const i=e.XpG();return e.DH7(i.estadoFiltro,a)||(i.estadoFiltro=a),e.Njj(a)}),e.bIt("ionChange",function(a){e.eBV(n);const i=e.XpG();return e.Njj(i.onFiltroChange(a))}),e.j41(5,"ion-select-option",15),e.EFF(6,"Todos"),e.k0s(),e.j41(7,"ion-select-option",16),e.EFF(8,"Pendientes"),e.k0s(),e.j41(9,"ion-select-option",17),e.EFF(10,"Completadas"),e.k0s(),e.j41(11,"ion-select-option",18),e.EFF(12,"Canceladas"),e.k0s()()(),e.j41(13,"ion-list"),e.DNE(14,y,13,9,"ion-item",19),e.k0s(),e.DNE(15,V,3,0,"ion-text",13),e.k0s()}if(2&o){const n=e.XpG();e.R7$(4),e.R50("ngModel",n.estadoFiltro),e.R7$(10),e.Y8G("ngForOf",n.citasFiltradas),e.R7$(),e.Y8G("ngIf",0===n.citasFiltradas.length)}}function H(o,r){if(1&o){const n=e.RV6();e.j41(0,"ion-item-sliding")(1,"ion-item",20),e.bIt("click",function(){const a=e.eBV(n).$implicit,i=e.XpG(2);return e.Njj(i.verDetalleMascota(a))}),e.j41(2,"ion-label")(3,"h2"),e.EFF(4),e.k0s(),e.j41(5,"p"),e.EFF(6),e.k0s(),e.j41(7,"p"),e.EFF(8),e.k0s()()()()}if(2&o){const n=r.$implicit;e.R7$(4),e.JRh(n.nombre),e.R7$(2),e.SpI("Especie: ",n.especie,""),e.R7$(2),e.SpI("Raza: ",n.raza,"")}}function S(o,r){1&o&&(e.j41(0,"ion-text",14)(1,"p"),e.EFF(2,"No hay mascotas registradas"),e.k0s()())}function P(o,r){if(1&o&&(e.j41(0,"div")(1,"ion-list"),e.DNE(2,H,9,3,"ion-item-sliding",12),e.k0s(),e.DNE(3,S,3,0,"ion-text",13),e.k0s()),2&o){const n=e.XpG();e.R7$(2),e.Y8G("ngForOf",n.mascotas),e.R7$(),e.Y8G("ngIf",0===n.mascotas.length)}}const G=[{path:"",component:(()=>{var o;class r{constructor(t,a,i,l,u,p){this.firestoreService=t,this.citasService=a,this.authService=i,this.alertController=l,this.modalController=u,this.router=p,this.citas=[],this.mascotas=[],this.usuarios=[],this.segmentValue="calendario",this.vetId=null,this.selectedDate=(new Date).toISOString(),this.citasDelDia=[],this.citasFiltradas=[],this.estadoFiltro="todos"}ngOnInit(){var t=this;return(0,m.A)(function*(){t.vetId=yield t.authService.getUserId(),t.vetId&&t.loadData()})()}loadData(){var t=this;return(0,m.A)(function*(){t.loadCitasVeterinario(),t.loadMascotasConCitas()})()}loadCitasVeterinario(){this.vetId&&this.citasService.getCitas().subscribe(t=>{this.citas=t.filter(a=>a.veterinarioId===this.vetId).sort((a,i)=>new Date(a.fecha).getTime()-new Date(i.fecha).getTime()),this.filtrarCitas(),this.actualizarCitasDelDia(),this.cargarInformacionUsuarios()},t=>{console.error("Error al cargar citas:",t)})}filtrarCitas(){this.citasFiltradas="todos"===this.estadoFiltro?this.citas:this.citas.filter(t=>t.estado===this.estadoFiltro)}onFiltroChange(t){this.estadoFiltro=t.detail.value,this.filtrarCitas()}loadMascotasConCitas(){this.vetId&&this.citasService.getCitas().subscribe(t=>{const a=[...new Set(t.filter(i=>i.veterinarioId===this.vetId).map(i=>i.mascotaId))];this.firestoreService.getAllMascotas().subscribe(i=>{this.mascotas=i.filter(l=>a.includes(l.id||""))})})}cargarInformacionUsuarios(){[...new Set(this.mascotas.map(a=>a.usuarioId))].forEach(a=>{this.firestoreService.getDoc("users",a).subscribe(i=>{const l=this.usuarios.findIndex(u=>u.id===a);-1===l?this.usuarios.push({id:a,...i}):this.usuarios[l]={id:a,...i}})})}segmentChanged(t){this.segmentValue=t.detail.value}onDateChanged(t){this.selectedDate=t.detail.value,this.actualizarCitasDelDia()}actualizarCitasDelDia(){const t=new Date(this.selectedDate).setHours(0,0,0,0);this.citasDelDia=this.citas.filter(a=>new Date(a.fecha).setHours(0,0,0,0)===t)}getMascotaInfo(t){return this.mascotas.find(a=>a.id===t)}getUserInfo(t){return this.usuarios.find(a=>a.id===t)}verDetalleCita(t){var a=this;return(0,m.A)(function*(){const i=a.getMascotaInfo(t.mascotaId),l=a.getUserInfo((null==i?void 0:i.usuarioId)||""),u=yield a.modalController.create({component:I,componentProps:{cita:t,mascota:i,dueno:l}});u.onDidDismiss().then(p=>{var F;"cambiarEstado"===(null===(F=p.data)||void 0===F?void 0:F.action)&&a.cambiarEstadoCita(p.data.cita)}),yield u.present()})()}getColorEstado(t){switch(t){case"pendiente":return"warning";case"en_proceso":return"primary";case"completada":return"success";case"cancelada":return"danger";default:return"medium"}}verDetalleMascota(t){var a=this;return(0,m.A)(function*(){const i=a.getUserInfo(t.usuarioId),l=a.citas.filter(p=>p.mascotaId===t.id);yield(yield a.modalController.create({component:E,componentProps:{mascota:t,dueno:i,citasMascota:l}})).present()})()}cambiarEstadoCita(t){var a=this;return(0,m.A)(function*(){yield(yield a.alertController.create({header:"Cambiar Estado",inputs:[{name:"estado",type:"radio",label:"Pendiente",value:"pendiente",checked:"pendiente"===t.estado},{name:"estado",type:"radio",label:"Completada",value:"completada",checked:"completada"===t.estado},{name:"estado",type:"radio",label:"Cancelada",value:"cancelada",checked:"cancelada"===t.estado}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Guardar",handler:l=>{t.id&&a.citasService.updateCita(t.id,{estado:l})}}]})).present()})()}logout(){var t=this;return(0,m.A)(function*(){var i;yield(yield t.alertController.create({header:"Cerrar Sesi\xf3n",message:"\xbfEst\xe1s seguro que deseas cerrar sesi\xf3n?",buttons:[{text:"Cancelar",role:"cancel"},{text:"S\xed, cerrar sesi\xf3n",handler:(i=(0,m.A)(function*(){try{yield t.authService.logout(),t.router.navigate(["/login"])}catch(l){console.error("Error al cerrar sesi\xf3n:",l)}}),function(){return i.apply(this,arguments)})}]})).present()})()}}return(o=r).\u0275fac=function(t){return new(t||o)(e.rXU(k.B),e.rXU(M.i),e.rXU(j.u),e.rXU(s.hG),e.rXU(s.W3),e.rXU(h.Ix))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-vet-home"]],decls:21,vars:4,consts:[["slot","end"],[3,"click"],["name","log-out-outline","color","danger"],[3,"ngModelChange","ionChange","ngModel"],["value","calendario"],["value","citas"],["value","mascotas"],["class","ion-padding",4,"ngIf"],[4,"ngIf"],[1,"ion-padding"],["presentation","date","locale","es-ES",3,"ionChange","value"],[1,"citas-dia"],[4,"ngFor","ngForOf"],["color","medium","class","ion-text-center",4,"ngIf"],["color","medium",1,"ion-text-center"],["value","todos"],["value","pendiente"],["value","completada"],["value","cancelada"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],[3,"color"]],template:function(t,a){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Portal Veterinario"),e.k0s(),e.j41(4,"ion-buttons",0)(5,"ion-button",1),e.bIt("click",function(){return a.logout()}),e.nrm(6,"ion-icon",2),e.k0s()()()(),e.j41(7,"ion-content")(8,"ion-segment",3),e.mxI("ngModelChange",function(l){return e.DH7(a.segmentValue,l)||(a.segmentValue=l),l}),e.bIt("ionChange",function(l){return a.segmentChanged(l)}),e.j41(9,"ion-segment-button",4)(10,"ion-label"),e.EFF(11,"Calendario"),e.k0s()(),e.j41(12,"ion-segment-button",5)(13,"ion-label"),e.EFF(14,"Mis Citas"),e.k0s()(),e.j41(15,"ion-segment-button",6)(16,"ion-label"),e.EFF(17,"Mascotas"),e.k0s()()(),e.DNE(18,R,9,7,"div",7)(19,$,16,3,"div",8)(20,P,4,2,"div",8),e.k0s()),2&t&&(e.R7$(8),e.R50("ngModel",a.segmentValue),e.R7$(10),e.Y8G("ngIf","calendario"===a.segmentValue),e.R7$(),e.Y8G("ngIf","citas"===a.segmentValue),e.R7$(),e.Y8G("ngIf","mascotas"===a.segmentValue))},dependencies:[d.Sq,d.bT,g.BC,g.vS,s.In,s.Jm,s.QW,s.W9,s.A9,s.eU,s.iq,s.uz,s.A7,s.he,s.nf,s.Gp,s.eP,s.Nm,s.Ip,s.IO,s.BC,s.ai,s.Je,d.vh]}),r})()}];let T=(()=>{var o;class r{}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[h.iI.forChild(G),h.iI]}),r})(),N=(()=>{var o;class r{}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[d.MD,g.YN,s.bv,T]}),r})()}}]);